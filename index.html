<!-- Simple HTML + JS version for GitHub Pages: index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Search Login ID</title>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" />
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold mb-4">Search Data by Login ID</h1>
    <p class="text-gray-600 mb-4">This page loads <strong>data.xlsx</strong> from the root of your GitHub repo.</p>

    <div class="flex gap-2 mb-4">
      <input id="search" type="text" placeholder="Search Login ID..." class="flex-1 p-3 rounded border" />
      <button onclick="clearSearch()" class="px-4 py-2 bg-white border rounded">Clear</button>
    </div>

    <div id="status" class="mb-4 text-sm text-gray-600"></div>

    <div class="overflow-x-auto">
      <table id="table" class="min-w-full bg-white rounded shadow divide-y"></table>
    </div>
  </div>

<script>
  let fullData = [];

  document.addEventListener("DOMContentLoaded", () => {
    loadExcel();
    document.getElementById("search").addEventListener("input", filterData);
  });

  async function loadExcel() {
    try {
      setStatus("Loading data.xlsx...");
      const res = await fetch("data.xlsx");
      if (!res.ok) throw new Error("File not found. Place data.xlsx in root.");

      const array = await res.arrayBuffer();
      const wb = XLSX.read(array, { type: "array" });
      const sheet = wb.Sheets[wb.SheetNames[0]];
      fullData = XLSX.utils.sheet_to_json(sheet, { defval: "" });

      renderTable(fullData);
      setStatus("Loaded " + fullData.length + " rows.");
    } catch (e) {
      setStatus("Error: " + e.message);
    }
  }

  function filterData() {
    const q = document.getElementById("search").value.toLowerCase();
    const filtered = fullData.filter(r =>
      Object.values(r).some(v => String(v).toLowerCase().includes(q))
    );
    renderTable(filtered);
    setStatus("Showing " + filtered.length + " of " + fullData.length + " rows.");
  }

  function renderTable(rows) {
    const table = document.getElementById("table");
    table.innerHTML = "";
    if (rows.length === 0) {
      table.innerHTML = `<tr><td class='p-4 text-center text-gray-500'>No data found</td></tr>`;
      return;
    }

    const headers = Object.keys(rows[0]);
    let thead = `<thead class='bg-gray-200'><tr>`;
    headers.forEach(h => thead += `<th class='px-4 py-2 text-left'>${h}</th>`);
    thead += `</tr></thead>`;

    let tbody = "<tbody>";
    rows.forEach(r => {
      tbody += `<tr class='border-t'>`;
      headers.forEach(h => tbody += `<td class='px-4 py-2'>${r[h]}</td>`);
      tbody += `</tr>`;
    });
    tbody += "</tbody>";

    table.innerHTML = thead + tbody;
  }

  function clearSearch() {
    document.getElementById("search").value = "";
    renderTable(fullData);
    setStatus("Showing all " + fullData.length + " rows.");
  }

  function setStatus(msg) {
    document.getElementById("status").innerText = msg;
  }
</script>
</body>
</html>
